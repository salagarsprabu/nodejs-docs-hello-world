# File: templates/stg.yml
parameters:
  name: 'dev'

stages:

- stage: ${{ parameters.name }}
  displayName: 'Deploy to the dev environment'
  dependsOn: Build
  condition: succeeded()
  jobs:
  - deployment: Deploy
    displayName: Deploy
    environment: dev
    variables:
    - group: Release
    pool:
      vmImage: $(vmImageName)
    strategy:
      runOnce:
        deploy:
          steps:
          - task: AzureWebApp@1
            displayName: 'Azure Web App Deploy: helloworld-nodejs-27869'
            inputs:
              azureSubscription: $(azureSubscription)
              appType: webAppLinux
              appName: $(WebAppNameDev)
              runtimeStack: 'NODE|16-lts'
              package: $(Pipeline.Workspace)/drop/$(Build.BuildId).zip
              startUpCommand: 'npm run start'